{"version":3,"file":"shadow-dom-manager.js","sources":["../../../../../../../../../../../../../node_modules/rrweb/es/rrweb/packages/rrweb/src/record/shadow-dom-manager.js"],"sourcesContent":["import { __assign } from '../../ext/tslib/tslib.es6.js';\nimport { initMutationObserver, initScrollObserver } from './observer.js';\nimport { patch } from '../utils.js';\n\nvar ShadowDomManager = (function () {\n    function ShadowDomManager(options) {\n        this.restorePatches = [];\n        this.mutationCb = options.mutationCb;\n        this.scrollCb = options.scrollCb;\n        this.bypassOptions = options.bypassOptions;\n        this.mirror = options.mirror;\n        var manager = this;\n        this.restorePatches.push(patch(HTMLElement.prototype, 'attachShadow', function (original) {\n            return function () {\n                var shadowRoot = original.apply(this, arguments);\n                if (this.shadowRoot)\n                    manager.addShadowRoot(this.shadowRoot, this.ownerDocument);\n                return shadowRoot;\n            };\n        }));\n    }\n    ShadowDomManager.prototype.addShadowRoot = function (shadowRoot, doc) {\n        initMutationObserver(__assign(__assign({}, this.bypassOptions), { doc: doc, mutationCb: this.mutationCb, mirror: this.mirror, shadowDomManager: this }), shadowRoot);\n        initScrollObserver(__assign(__assign({}, this.bypassOptions), { scrollCb: this.scrollCb, doc: shadowRoot, mirror: this.mirror }));\n    };\n    ShadowDomManager.prototype.observeAttachShadow = function (iframeElement) {\n        if (iframeElement.contentWindow) {\n            var manager_1 = this;\n            this.restorePatches.push(patch(iframeElement.contentWindow.HTMLElement.prototype, 'attachShadow', function (original) {\n                return function () {\n                    var shadowRoot = original.apply(this, arguments);\n                    if (this.shadowRoot)\n                        manager_1.addShadowRoot(this.shadowRoot, iframeElement.contentDocument);\n                    return shadowRoot;\n                };\n            }));\n        }\n    };\n    ShadowDomManager.prototype.reset = function () {\n        this.restorePatches.forEach(function (restorePatch) { return restorePatch(); });\n    };\n    return ShadowDomManager;\n}());\n\nexport { ShadowDomManager };\n"],"names":[],"mappings":";;;;AAIA,IAAA,gBAAA,IAAA,YAAA;AACA,IAAA,SAAA,gBAAA,CAAA,OAAA,EAAA;AACA,QAAA,IAAA,CAAA,cAAA,GAAA,EAAA,CAAA;AACA,QAAA,IAAA,CAAA,UAAA,GAAA,OAAA,CAAA,UAAA,CAAA;AACA,QAAA,IAAA,CAAA,QAAA,GAAA,OAAA,CAAA,QAAA,CAAA;AACA,QAAA,IAAA,CAAA,aAAA,GAAA,OAAA,CAAA,aAAA,CAAA;AACA,QAAA,IAAA,CAAA,MAAA,GAAA,OAAA,CAAA,MAAA,CAAA;AACA,QAAA,IAAA,OAAA,GAAA,IAAA,CAAA;AACA,QAAA,IAAA,CAAA,cAAA,CAAA,IAAA,CAAA,KAAA,CAAA,WAAA,CAAA,SAAA,EAAA,cAAA,EAAA,UAAA,QAAA,EAAA;AACA,YAAA,OAAA,YAAA;AACA,gBAAA,IAAA,UAAA,GAAA,QAAA,CAAA,KAAA,CAAA,IAAA,EAAA,SAAA,CAAA,CAAA;AACA,gBAAA,IAAA,IAAA,CAAA,UAAA;AACA,oBAAA,OAAA,CAAA,aAAA,CAAA,IAAA,CAAA,UAAA,EAAA,IAAA,CAAA,aAAA,CAAA,CAAA;AACA,gBAAA,OAAA,UAAA,CAAA;AACA,aAAA,CAAA;AACA,SAAA,CAAA,CAAA,CAAA;AACA,KAAA;AACA,IAAA,gBAAA,CAAA,SAAA,CAAA,aAAA,GAAA,UAAA,UAAA,EAAA,GAAA,EAAA;AACA,QAAA,oBAAA,CAAA,QAAA,CAAA,QAAA,CAAA,EAAA,EAAA,IAAA,CAAA,aAAA,CAAA,EAAA,EAAA,GAAA,EAAA,GAAA,EAAA,UAAA,EAAA,IAAA,CAAA,UAAA,EAAA,MAAA,EAAA,IAAA,CAAA,MAAA,EAAA,gBAAA,EAAA,IAAA,EAAA,CAAA,EAAA,UAAA,CAAA,CAAA;AACA,QAAA,kBAAA,CAAA,QAAA,CAAA,QAAA,CAAA,EAAA,EAAA,IAAA,CAAA,aAAA,CAAA,EAAA,EAAA,QAAA,EAAA,IAAA,CAAA,QAAA,EAAA,GAAA,EAAA,UAAA,EAAA,MAAA,EAAA,IAAA,CAAA,MAAA,EAAA,CAAA,CAAA,CAAA;AACA,KAAA,CAAA;AACA,IAAA,gBAAA,CAAA,SAAA,CAAA,mBAAA,GAAA,UAAA,aAAA,EAAA;AACA,QAAA,IAAA,aAAA,CAAA,aAAA,EAAA;AACA,YAAA,IAAA,SAAA,GAAA,IAAA,CAAA;AACA,YAAA,IAAA,CAAA,cAAA,CAAA,IAAA,CAAA,KAAA,CAAA,aAAA,CAAA,aAAA,CAAA,WAAA,CAAA,SAAA,EAAA,cAAA,EAAA,UAAA,QAAA,EAAA;AACA,gBAAA,OAAA,YAAA;AACA,oBAAA,IAAA,UAAA,GAAA,QAAA,CAAA,KAAA,CAAA,IAAA,EAAA,SAAA,CAAA,CAAA;AACA,oBAAA,IAAA,IAAA,CAAA,UAAA;AACA,wBAAA,SAAA,CAAA,aAAA,CAAA,IAAA,CAAA,UAAA,EAAA,aAAA,CAAA,eAAA,CAAA,CAAA;AACA,oBAAA,OAAA,UAAA,CAAA;AACA,iBAAA,CAAA;AACA,aAAA,CAAA,CAAA,CAAA;AACA,SAAA;AACA,KAAA,CAAA;AACA,IAAA,gBAAA,CAAA,SAAA,CAAA,KAAA,GAAA,YAAA;AACA,QAAA,IAAA,CAAA,cAAA,CAAA,OAAA,CAAA,UAAA,YAAA,EAAA,EAAA,OAAA,YAAA,EAAA,CAAA,EAAA,CAAA,CAAA;AACA,KAAA,CAAA;AACA,IAAA,OAAA,gBAAA,CAAA;AACA,CAAA,EAAA;;;;"}