{"version":3,"file":"webgl.js","sources":["../../../../../../../../../../../../../../../node_modules/rrweb/es/rrweb/packages/rrweb/src/record/observers/canvas/webgl.js"],"sourcesContent":["import { __spreadArray, __read, __values } from '../../../../ext/tslib/tslib.es6.js';\nimport { CanvasContext } from '../../../types.js';\nimport { patch, isBlocked, hookSetter } from '../../../utils.js';\nimport { saveWebGLVar, serializeArgs } from './serialize-args.js';\n\nfunction patchGLPrototype(prototype, type, cb, blockClass, mirror, win) {\n    var e_1, _a;\n    var handlers = [];\n    var props = Object.getOwnPropertyNames(prototype);\n    var _loop_1 = function (prop) {\n        try {\n            if (typeof prototype[prop] !== 'function') {\n                return \"continue\";\n            }\n            var restoreHandler = patch(prototype, prop, function (original) {\n                return function () {\n                    var args = [];\n                    for (var _i = 0; _i < arguments.length; _i++) {\n                        args[_i] = arguments[_i];\n                    }\n                    var result = original.apply(this, args);\n                    saveWebGLVar(result, win, prototype);\n                    if (!isBlocked(this.canvas, blockClass)) {\n                        var id = mirror.getId(this.canvas);\n                        var recordArgs = serializeArgs(__spreadArray([], __read(args), false), win, prototype);\n                        var mutation = {\n                            type: type,\n                            property: prop,\n                            args: recordArgs,\n                        };\n                        cb(this.canvas, mutation);\n                    }\n                    return result;\n                };\n            });\n            handlers.push(restoreHandler);\n        }\n        catch (_b) {\n            var hookHandler = hookSetter(prototype, prop, {\n                set: function (v) {\n                    cb(this.canvas, {\n                        type: type,\n                        property: prop,\n                        args: [v],\n                        setter: true,\n                    });\n                },\n            });\n            handlers.push(hookHandler);\n        }\n    };\n    try {\n        for (var props_1 = __values(props), props_1_1 = props_1.next(); !props_1_1.done; props_1_1 = props_1.next()) {\n            var prop = props_1_1.value;\n            _loop_1(prop);\n        }\n    }\n    catch (e_1_1) { e_1 = { error: e_1_1 }; }\n    finally {\n        try {\n            if (props_1_1 && !props_1_1.done && (_a = props_1.return)) _a.call(props_1);\n        }\n        finally { if (e_1) throw e_1.error; }\n    }\n    return handlers;\n}\nfunction initCanvasWebGLMutationObserver(cb, win, blockClass, mirror) {\n    var handlers = [];\n    handlers.push.apply(handlers, __spreadArray([], __read(patchGLPrototype(win.WebGLRenderingContext.prototype, CanvasContext.WebGL, cb, blockClass, mirror, win)), false));\n    if (typeof win.WebGL2RenderingContext !== 'undefined') {\n        handlers.push.apply(handlers, __spreadArray([], __read(patchGLPrototype(win.WebGL2RenderingContext.prototype, CanvasContext.WebGL2, cb, blockClass, mirror, win)), false));\n    }\n    return function () {\n        handlers.forEach(function (h) { return h(); });\n    };\n}\n\nexport default initCanvasWebGLMutationObserver;\n"],"names":["patch","saveWebGLVar","isBlocked","serializeArgs","__spreadArray","__read","hookSetter","__values","CanvasContext"],"mappings":"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"}