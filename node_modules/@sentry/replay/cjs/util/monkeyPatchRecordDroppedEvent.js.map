{"version":3,"file":"monkeyPatchRecordDroppedEvent.js","sources":["../../../../src/util/monkeyPatchRecordDroppedEvent.ts"],"sourcesContent":["import { getCurrentHub } from '@sentry/core';\nimport { Client, DataCategory, Event, EventDropReason } from '@sentry/types';\n\nlet _originalRecordDroppedEvent: Client['recordDroppedEvent'] | undefined;\n\n/**\n * Overwrite the `recordDroppedEvent` method on the client, so we can find out which events were dropped.\n * */\nexport function overwriteRecordDroppedEvent(errorIds: Set<string>): void {\n  const client = getCurrentHub().getClient();\n\n  if (!client) {\n    return;\n  }\n\n  const _originalCallback = client.recordDroppedEvent.bind(client);\n\n  const recordDroppedEvent: Client['recordDroppedEvent'] = (\n    reason: EventDropReason,\n    category: DataCategory,\n    event?: Event,\n  ): void => {\n    if (event && !event.type && event.event_id) {\n      errorIds.delete(event.event_id);\n    }\n\n    return _originalCallback(reason, category, event);\n  };\n\n  client.recordDroppedEvent = recordDroppedEvent;\n  _originalRecordDroppedEvent = _originalCallback;\n}\n\n/**\n * Restore the original method.\n * */\nexport function restoreRecordDroppedEvent(): void {\n  const client = getCurrentHub().getClient();\n\n  if (!client || !_originalRecordDroppedEvent) {\n    return;\n  }\n\n  client.recordDroppedEvent = _originalRecordDroppedEvent;\n}\n"],"names":["getCurrentHub"],"mappings":";;;;AAGA,IAAA,2BAAA,CAAA;AACA;AACA;AACA;AACA;AACA,SAAA,2BAAA,CAAA,QAAA,EAAA;AACA,EAAA,MAAA,MAAA,GAAAA,kBAAA,EAAA,CAAA,SAAA,EAAA,CAAA;AACA;AACA,EAAA,IAAA,CAAA,MAAA,EAAA;AACA,IAAA,OAAA;AACA,GAAA;AACA;AACA,EAAA,MAAA,iBAAA,GAAA,MAAA,CAAA,kBAAA,CAAA,IAAA,CAAA,MAAA,CAAA,CAAA;AACA;AACA,EAAA,MAAA,kBAAA,GAAA;AACA,IAAA,MAAA;AACA,IAAA,QAAA;AACA,IAAA,KAAA;AACA,OAAA;AACA,IAAA,IAAA,KAAA,IAAA,CAAA,KAAA,CAAA,IAAA,IAAA,KAAA,CAAA,QAAA,EAAA;AACA,MAAA,QAAA,CAAA,MAAA,CAAA,KAAA,CAAA,QAAA,CAAA,CAAA;AACA,KAAA;AACA;AACA,IAAA,OAAA,iBAAA,CAAA,MAAA,EAAA,QAAA,EAAA,KAAA,CAAA,CAAA;AACA,GAAA,CAAA;AACA;AACA,EAAA,MAAA,CAAA,kBAAA,GAAA,kBAAA,CAAA;AACA,EAAA,2BAAA,GAAA,iBAAA,CAAA;AACA,CAAA;AACA;AACA;AACA;AACA;AACA,SAAA,yBAAA,GAAA;AACA,EAAA,MAAA,MAAA,GAAAA,kBAAA,EAAA,CAAA,SAAA,EAAA,CAAA;AACA;AACA,EAAA,IAAA,CAAA,MAAA,IAAA,CAAA,2BAAA,EAAA;AACA,IAAA,OAAA;AACA,GAAA;AACA;AACA,EAAA,MAAA,CAAA,kBAAA,GAAA,2BAAA,CAAA;AACA;;;;;"}